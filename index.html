<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>The Xpedition Presents: The Traitor</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;800&family=Cormorant+Garamond:wght@400;500;600;700&display=swap" rel="stylesheet">
<meta name="theme-color" content="#2a0004"/>
<style>
:root{ --bg:#180106; --bg-2:#2b0006; --gold:#f1d38a; --ink:#e9e2dc; --venom:#27c76f; --shadow:rgba(0,0,0,.65) }
*{box-sizing:border-box}
html,body{height:100%}
/* Knife cursor global */
html, body, a, button, .btn, .cta-sound, .card, .avatar, * { cursor: url('assets/knife.png') 0 0, auto; }
body{
  margin:0;
  background:
    radial-gradient(1000px 600px at 30% 0%, #3d0009 0%, transparent 60%),
    radial-gradient(900px 600px at 70% 100%, #220005 0%, transparent 60%),
    linear-gradient(180deg, var(--bg) 0%, var(--bg-2) 100%);
  color:var(--ink);
  font-family: "Cormorant Garamond", serif;
  line-height:1.45;
  overflow-x:hidden;
}
body.gated{ overflow:hidden; }
img{max-width:100%; display:block}
.container{max-width:1200px; margin:0 auto; padding:24px 18px}
.gold-emboss{font-family:"Cinzel",serif; letter-spacing:.08em; text-transform:uppercase; color:var(--gold);
  text-shadow:0 1px 0 #fff2,0 2px 6px #0009,0 0 30px rgba(255,228,134,.08),0 0 70px rgba(255,215,128,.05)}

/* Header */
.header{position:relative; display:flex; gap:18px; align-items:center; justify-content:space-between;
  padding:16px 18px; border-bottom:1px solid #ffffff1a; background:linear-gradient(180deg,#25000677,#0000); backdrop-filter:blur(6px)}
.brand{display:flex; align-items:center; gap:14px}
.brand img{height:72px; width:auto; filter:drop-shadow(0 8px 16px var(--shadow))}
.title-wrap h1{font-size:28px}
.title-wrap .kicker{font-size:14px; opacity:.85; letter-spacing:.1em}
.header-actions{display:flex; gap:10px; align-items:center}
.cta-sound,.cta-home{display:flex; gap:10px; align-items:center; border:1px solid #ffffff22; background:#0000003a; color:#fff;
  padding:10px 14px; border-radius:10px; cursor:pointer; box-shadow:inset 0 0 0 1px #ffffff12; text-decoration:none}
.cta-sound[aria-pressed="true"]{box-shadow: inset 0 0 0 2px #caa44e88;}
.cta-sound:hover,.cta-home:hover{background:#00000055}

.hero{ padding:20px 0 10px }
.hero img{ width:100%; max-height:64vh; object-fit:cover; border-radius:18px; box-shadow:0 30px 60px var(--shadow) }

.divider{ margin:28px auto; height:2px; width:min(720px,90%); background:linear-gradient(90deg,transparent,var(--gold),transparent); position:relative }
.divider::after{ content:""; position:absolute; left:50%; transform:translateX(-50%); width:180px; height:36px; background:radial-gradient(closest-side,#f7e9b4 20%,#0000 70%); filter:blur(6px); opacity:.4; top:-18px }


/* Panel base */
.panel{ max-width:auto; margin:1 auto; background:linear-gradient(180deg,#0b0004cc,#0b000480); border:1px solid #ffffff20; border-radius:18px; padding:22px; box-shadow:0 30px 80px rgba(0,0,0,.55) }
/* Panel narrativo con ancho idéntico al contenido (1088) + padding (22*2) = 1132 */
.panel.narrative-shell{ width:auto; max-width:auto; margin-left:auto; margin-right:auto; }

/* ===== Layout narrativo ===== */
.narrative{ display:grid;  gap:16px; justify-items:center }
  width:auto;                            /* 720 + 28 + 340 */
  margin:3 auto;
  display:grid; grid-template-columns:820px 38px 340px; align-items:start;
}
.narrative .prose{ width:auto; grid-column:1 }
.narrative .gap{ width:auto; grid-column:2 }
.narrative .frame{ width:auto; grid-column:3;
  border-radius:16px; overflow:hidden; border:1px solid #ffffff24;
  box-shadow:0 20px 50px var(--shadow); background:#0a0003;
}
.narrative .frame img{ width:360px; height:auto; display:block }

/* Grid participantes */
.grid{ display:grid; grid-template-columns:repeat(5,minmax(190px,1fr)); gap:16px; justify-items:center }
@media (max-width:1100px){ .grid{ grid-template-columns:repeat(4,minmax(160px,1fr)) } }
@media (max-width:850px){ .grid{ grid-template-columns:repeat(3,minmax(160px,1fr)) } }
@media (max-width:600px){ .grid{ grid-template-columns:repeat(2,minmax(160px,1fr)) } }

.card{ position:relative; width:100%; border-radius:16px; padding:10px; background:linear-gradient(180deg,#150006,#29000a);
  border:1px solid #ffffff1a; box-shadow:0 10px 30px var(--shadow); overflow:hidden; cursor:pointer }
.card .avatar{ position:relative; height:220px; border-radius:12px; background:#0c0003; border:1px solid #ffffff1a; overflow:hidden; z-index:0; touch-action:manipulation }
.card .avatar img{ position:relative; z-index:0; width:100%; height:100%; object-fit:cover }
/* Sin viñeta/oscurecido */
.card .avatar::after{ display:none !important; }
.card .name{ margin:10px 0 2px; font-weight:700; letter-spacing:.04em; font-size:19px; text-align:center }
.card .estado, .card .causa{ margin:0; opacity:.95; text-align:center }
.card .estado{ font-weight:700 }
.estado.alive{ color:#27c76f }
.estado.dead{ color:#d63a3a }
.card .mark{ position:absolute; right:8px; bottom:8px; font-size:22px; filter:drop-shadow(0 2px 2px #0009); z-index:3 }
.card:focus-within .fx{ opacity:1 }

.monogram{ display:grid; place-items:center; height:100%; width:100%; font-family:"Cinzel",serif; font-size:64px; color:#fff; opacity:.9; background:#120007; text-shadow:0 4px 10px #000a }

/* FX */
.fx{ position:absolute; inset:0; pointer-events:none; opacity:0; transition:opacity .25s ease; z-index:2 }
.card:hover .fx, .card.active .fx, .card .avatar:hover .fx{ opacity:1 }
.fx-glow::before{ content:""; position:absolute; inset:-25%; background:radial-gradient(closest-side, rgba(255,215,128,.45), transparent 65%); filter: blur(12px); animation: pulse 1.6s ease-in-out infinite }
@keyframes pulse{ 0%,100%{transform:scale(.9)} 50%{transform:scale(1.1)} }
.fx-missing::after{ content:"?"; position:absolute; inset:0; display:grid; place-items:center; font-family:"Cinzel", serif; font-size:120px; color:#fff; text-shadow: 0 0 18px #fff8, 0 0 60px #fff6; animation: flicker 1.6s infinite }
@keyframes flicker{ 0%,100%{opacity:.25} 45%{opacity:.85} 50%{opacity:.35} 60%{opacity:.9} }
.fx-fire{ overflow:hidden }
.fx-fire::before, .fx-fire::after{ content:""; position:absolute; left:-10%; right:-10%; bottom:-25%; height:60%;
  background:radial-gradient(60px 30px at 10% 90%, #ffcb52aa, transparent 70%),radial-gradient(70px 36px at 30% 85%, #ffad33cc, transparent 70%),radial-gradient(70px 34px at 50% 95%, #ff7a1fcc, transparent 70%),radial-gradient(60px 30px at 70% 90%, #ffcb52aa, transparent 70%),radial-gradient(80px 38px at 90% 88%, #ffaa00cc, transparent 70%);
  filter: blur(6px) contrast(1.2); animation: flames 1.2s linear infinite }
.fx-fire::after{ background:radial-gradient(60px 30px at 15% 95%, #ffd58ecc, transparent 70%),radial-gradient(70px 36px at 35% 92%, #ffbf58cc, transparent 70%),radial-gradient(70px 34px at 55% 100%, #ff9d3acc, transparent 70%),radial-gradient(60px 30px at 75% 94%, #ffd58ecc, transparent 70%),radial-gradient(80px 38px at 95% 92%, #ffc56bcc, transparent 70%); animation: flames 1.6s linear infinite reverse; opacity:.9 }
@keyframes flames{ 0%{ transform:translateY(20%) } 100%{ transform:translateY(-10%) } }
.fx-blood::before{ content:""; position:absolute; inset:-2% -2% 20% -2%;
  background:radial-gradient(40px 20px at 20% 20%, #9e0f17, transparent 70%),radial-gradient(30px 18px at 50% 35%, #8d0d15, transparent 70%),radial-gradient(34px 16px at 75% 25%, #7c0c13, transparent 70%); filter: blur(1px); opacity:.95 }
.fx-blood::after{ content:""; position:absolute; left:8%; width:10px; top:0; bottom:-30%; background: linear-gradient(#8c0d14, #3d0407); border-radius:8px; filter: blur(.3px); animation: drip 1.8s ease-in-out infinite }
@keyframes drip{ 0%{ transform: translateY(-120%); opacity:0 } 15%{ opacity:1 } 70%{ transform: translateY(20%) } 100%{ opacity:0 } }
.fx-venom::before{ content:""; position:absolute; left:-8%; right:-8%; top:-30%; height:60%;
  background:radial-gradient(60px 30px at 20% 10%, #54ffb0cc, transparent 70%),radial-gradient(70px 36px at 40% 12%, #31e78fcc, transparent 70%),radial-gradient(70px 34px at 65% 8%,  #20d67fcc, transparent 70%),radial-gradient(60px 30px at 85% 14%, #54ffb0cc, transparent 70%);
  filter: blur(6px) saturate(120%); animation: ooze 2.2s ease-in-out infinite }
.fx-venom::after{ content:""; position:absolute; left:18%; top:-10%; width:10px; bottom:60%; background: linear-gradient(#27c76f, #0a3b23); border-radius:8px; filter: blur(.3px); animation: ooze 2.2s ease-in-out infinite reverse }

.footer{ text-align:center; padding:20px 0 50px; opacity:.8; font-size:14px }
.small{ font-size:12px; opacity:.8 }

/* Track record */
.track{ margin:40px auto 80px; border-top:1px solid #ffffff22; padding-top:18px }
.track .board{ min-height:220px; border:1px dashed #ffffff33; border-radius:12px; display:grid; place-items:center; padding:20px; color:#ffffffaa }
.track .board img{ max-width:100%; height:auto; display:block }

/* Gate + Doors */
#gate{ position:fixed; inset:0; background: radial-gradient(1200px 800px at 50% 30%, #3a000d, #0b0003); display:grid; place-items:center; z-index:1000; color:#fff; }
.gate-card{ text-align:center; max-width:720px; padding:28px; border-radius:18px; background:#0b0004cc; border:1px solid #ffffff22; box-shadow:0 30px 80px var(--shadow) }
.gate-card h2{ font-size:34px }
.btn{ display:inline-block; padding:12px 18px; border-radius:10px; border:1px solid #caa44e88; background:linear-gradient(180deg,#3a1d00,#1a0d00); color:#f7e9b4; font-weight:700; letter-spacing:.08em; text-transform:uppercase; cursor:pointer }
.btn:hover{ filter:brightness(1.1) } .btn:active{ transform:translateY(1px) }

#doors{ position:fixed; inset:0; display:none; z-index:1200; pointer-events:none; }
#doors .panel{ position:absolute; top:0; width:50%; height:100%; background: linear-gradient(180deg, #2b0007, #120003); box-shadow: inset 0 0 120px #000a, 0 0 40px #000a; border:1px solid #5a1a22; will-change: transform; }
#doors .left{ left:0; border-right:1px solid #5a1a22; transform:translateX(0); }
#doors .right{ right:0; border-left:1px solid #5a1a22; transform:translateX(0); }
#doors.open .left{ animation: openLeft 1.2s ease forwards }
#doors.open .right{ animation: openRight 1.2s ease forwards }
@keyframes openLeft{ 0%{ transform: translateX(0) } 100%{ transform: translateX(-100%) } }
@keyframes openRight{ 0%{ transform: translateX(0) } 100%{ transform: translateX(100%) } }

/* Lightbox */
.lightbox{ position:fixed; inset:0; display:none; place-items:center; background:rgba(0,0,0,.86); z-index:1400 }
.lightbox.open{ display:grid }
.lb-inner{ position:relative; width:min(58vw, 520px) }
@media (max-width: 700px){ .lb-inner{ width:92vw } }
.lb-img{ width:100%; max-height:56vh; object-fit:contain; border-radius:16px; box-shadow:0 30px 80px #000; display:block; background:#000 }
.lb-close{ position:absolute; top:-14px; right:-14px; width:44px; height:44px; border-radius:50%; background:#1b0a0e; border:1px solid #ffffff33; color:#fff; display:grid; place-items:center; font-size:20px; cursor:pointer }
.lb-legend{ margin-top:14px; background:#0b0008; border:1px solid #ffffff22; border-radius:12px; padding:14px 16px }
.lb-name{ font-family:"Cinzel",serif; font-size:22px; letter-spacing:.06em; text-align:center }
.lb-estado{ font-size:26px; font-weight:800; margin:.3rem 0; text-align:center }
.lb-causa{ opacity:.9; text-align:center }
.status-alive{ color:#27c76f; text-shadow:0 0 12px rgba(39,199,111,.4) }
.status-dead{ color:#d63a3a }
.status-missing{ color:#fff; text-shadow:0 0 14px #fff8 }
@keyframes textReveal{ 0%{ letter-spacing:.6em; opacity:0; filter:blur(3px) } 60%{ letter-spacing:.12em; opacity:.9; filter:blur(0) } 100%{ letter-spacing:.06em; opacity:1 } }
/* <- activar animación en estado */
.reveal{ animation: textReveal .9s ease both; }

/* ===== Overlay de LOGO al entrar ===== */
#logoOverlay{ position:fixed; inset:0; display:none; place-items:center; z-index:1300; pointer-events:none; }
#logoOverlay.show{ display:grid; }
#logoOverlay .logo{ width:min(70vw, 700px); max-width:700px; filter:drop-shadow(0 20px 80px #0008); opacity:0; transform:scale(.96); transition:opacity .5s ease, transform .6s ease; }
#logoOverlay.show .logo{ opacity:1; transform:scale(1); }
#logoOverlay.fade .logo{ opacity:0; filter:blur(2px); transition: opacity .8s ease, filter .8s ease; }
/* ===== FIX RESPONSIVE DEL BLOQUE NARRATIVO (MÓVIL) ===== */
@media (max-width: 900px){
  .panel.narrative-shell{
    width: auto;
    max-width: 100%;
    margin: 0 14px;
    padding: 18px;
    transform: none !important;
  }

  .narrative{
    width: auto;
    margin: 0;
    display: grid;
    grid-template-columns: 1fr;   /* una sola columna */
    gap: 16px;
    align-items: start;
  }

  .narrative .gap{ display: none; }

  .narrative .prose{ width: auto; }

  .narrative .frame{
    width: 100%;
    max-width: 540px;
    margin: 0 auto;
    border-radius: 14px;
  }
  .narrative .frame img{
    display: block;
    width: 100%;
    height: auto;
  }

  .section .lead{
    max-width: 40ch;
    margin: 0 auto 10px;
  }
}

@media (max-width: 480px){
  .prose{ font-size: 18px; }
  .section .lead{ font-size: 18px; }
}
@media (max-width: 900px){
  .narrative .prose{
    width: auto !important;
    max-width: 42ch !important;   /* ancho óptimo de línea */
    margin: 0 auto !important;
    font-size: 18px !important;
    line-height: 1.65 !important;
    text-align: justify !important;
    text-wrap: pretty;            /* si el navegador lo soporta */
    hyphens: auto;                /* guiones automáticos */
    -webkit-hyphens: auto;        /* Safari iOS */
    overflow-wrap: break-word;    /* evita desbordes */
    word-break: normal;
  }

  /* Espaciado entre párrafos */
  .narrative .prose p{ margin: 0 0 0.9em !important; }

  /* Quitar la capitular en móvil para no “apretar” la primera línea */
  .dropcap::first-letter{
    float: none !important;
    font-size: 1em !important;
    margin: 0 !important;
    color: inherit !important;
    text-shadow: none !important;
  }
}

@media (max-width: 480px){
  .narrative .prose{
    max-width: 36ch !important;
    font-size: 17px !important;
    line-height: 1.7 !important;
  }
}
</style>
</head>
<body class="gated">
<header class="header container">
  <div class="brand">
    <img src="The Traitor 1 Logo Color.png" alt="The Traitor Logo" onerror="this.style.display='none'"/>
    <div class="title-wrap">
      <div class="kicker gold-emboss">The Xpedition Presents:</div>
      <h1 class="gold-emboss">The Traitor</h1>
    </div>
  </div>
  <div class="header-actions">
    <button class="cta-sound" id="toggleSound" aria-pressed="false" title="Música de fondo"><span>🔊</span><span>Sonido</span></button>
    <a class="cta-home" id="homeBtn" href="https://thexpedition.github.io/The-Xpedition-Official/" target="_blank" rel="noopener">Inicio</a>
  </div>
</header>

<main>
  <section class="container hero">
    <img src="The Traitor Portada.png" alt="Portada The Traitor" onerror="this.style.display='none'"/>
  </section>

  <div class="divider"></div>

  <section class="container section scroll-mask">
  <div class="panel narrative-shell">
    <p class="lead gold-emboss" style="text-align:center">
      THE TRAITOR: CRÓNICA DE UN RITUAL DE MÁSCARAS    </p>

    <div class="narrative">
      <div class="prose dropcap">
        <p>Treinta nombres, una invitación y una mansión con apellido. La familia Mind, prestigiosa y hermética, convocó a un grupo selecto para una velada privada que terminó convertida —según una única sobreviviente— en un <em>ritual de sacrificios</em> de dos semanas.</p>

        <p>Esa sobreviviente es <strong>Xina Ro</strong>. Dice que fueron encerrados, sometidos y torturados por personas enmascaradas. Afirma haber reconocido entre los presentes a <strong>Bonju</strong>, la reconocida presentadora de The Xpedition, quien —según Xina— no tenía máscara y abandonó la mansión poco antes de que la pesadilla empezara, como si no estuviera allí por obligación.</p>

        <p>Después de esas fuertes acusaciones la policía irrumpió, pero no halló pruebas: ni sangre, ni marcas, ni registros. Todo estaba impecable, como si nada hubiera ocurrido. La ciudad se dividió entre quienes aseguran que hubo dinero de por medio, quienes aseguran que Xina es una desquiciada fabuladora y quienes ven la Mansión Mind como una familia con un misterio demasiado calculado.</p>

<p>Aunque Xina Ro dudó en contar más sobre los supuestos hechos al principio, tras la falta de credibilidad en sus palabras finalmente se rompió y contó que muchas de las victimas no fueron asesinados por terceros, si no por los mismos 30 invitados que estaban desde el primer día y según, cada uno buscando un beneficio personal.</p>


        <p>Hoy, Xina Ro permanece en un hospital psiquiátrico. Los nombres que ella aseguro eran de las víctimas, algunos empezaron a coincidir con reportes de personas desaparecidas. Para unos, es evidencia. Para otros, una coincidencia aprendida de los periódicos.</p>

        <p>Hasta la fecha, el caso sigue sin resolver y la Mansión Mind sigue ahí, ocultando posibles secretos que jamás sabremos.</p>
      </div>

      <div class="gap" aria-hidden="true"></div>

      <figure class="frame">
        <img src="assets/insert.jpg" alt="Dossier fotográfico de la Mansión Mind">
      </figure>
    </div>
  </div>
</section>


  <div class="divider"></div>

  <section class="container">
    <div class="panel">
      <h2 class="gold-emboss" style="text-align:center">Participantes</h2>
      <div id="grid" class="grid"></div>
    </div>
  </section>

  <section class="container track" id="track">
    <div class="panel">
      <h2 class="gold-emboss" style="text-align:center">Track Record</h2>
      <div class="board"><img src="assets/track.png" alt="Track Record"></div>
    </div>
  </section>
</main>

<footer class="footer container">
  <div>© The Xpedition — The Traitor</div>
</footer>

<audio id="bgAudio" src="audio/theme.mp3" preload="auto" loop></audio>

<div id="gate"><div class="gate-card"><h2 class="gold-emboss">La mansión aguarda</h2><No puedes confiar en nadie.</p><button id="enterBtn" class="btn">Entrar</button></div></div>
<div id="doors"><div class="panel left"></div><div class="panel right"></div></div>

<!-- Overlay de logo transparente -->
<div id="logoOverlay" aria-hidden="true">
  <img class="logo" src="The Traitor 1 Logo Transparente.png" alt="The Traitor Logo (overlay)">
</div>

<!-- Lightbox -->
<div class="lightbox" id="lightbox" aria-hidden="true">
  <div class="lb-inner">
    <img class="lb-img" id="lbImg" alt=""/>
    <button class="lb-close" id="lbClose" title="Cerrar">✕</button>
    <div class="lb-legend">
      <div class="lb-name" id="lbName"></div>
      <div class="lb-estado" id="lbEstado"></div>
      <div class="lb-causa" id="lbCausa"></div>
    </div>
  </div>
</div>

<script>
try { if ('scrollRestoration' in history) history.scrollRestoration = 'manual'; } catch(e){}
window.addEventListener('load', ()=>{ window.scrollTo(0,0); const g=document.getElementById('gate'), d=document.getElementById('doors'); document.body.classList.add('gated'); if(d){d.classList.remove('open'); d.style.display='none'} if(g){g.style.display='grid'} });
window.addEventListener('pageshow', ()=>{ window.scrollTo(0,0); const g=document.getElementById('gate'), d=document.getElementById('doors'), a=document.getElementById('bgAudio'); if(d){d.classList.remove('open'); d.style.display='none'} if(g){g.style.display='grid'} document.body.classList.add('gated'); if(a){ a.pause(); document.getElementById('toggleSound')?.setAttribute('aria-pressed','false') }});

// Participantes (Vitany 5ta, femenino)
const participantes=[
  {n:'Xina Ro', e:'Viva', c:'Escapó en la Noche 12', m:'vivo'},
  {n:'Eduardo', e:'Muerto', c:'Ejecutado en la Noche 12', m:'ejecutado'},
  {n:'Esteban', e:'Muerto', c:'Ejecutado en la Noche 12', m:'ejecutado'},
  {n:'Carlos Harrington', e:'Muerto', c:'Ejecutado en la Noche 12', m:'ejecutado'},
  {n:'Vitany Glambert', e:'Muerta', c:'Asesinada en la Noche 12', m:'asesinado'},
  {n:'Stalin Mango', e:'Muerto', c:'Ejecutado en la Noche 11', m:'ejecutado'},
  {n:'Alex Yohender', e:'Muerto', c:'Asesinado en la Noche 11', m:'asesinado'},
  {n:'Plastique Doll', e:'Muerta', c:'Ejecutada en la Noche 10', m:'ejecutado'},
  {n:'Daelly', e:'Muerta', c:'Asesinada en la Noche 10', m:'asesinado'},
  {n:'Andromeda', e:'Muerta', c:'Envenenada en la Noche 9', m:'envenenado'},
  {n:'Isabel', e:'Muerta', c:'Envenenada en la Noche 9', m:'envenenado'},
  {n:'Jose Serna', e:'Muerto', c:'Envenenado en la Noche 9', m:'envenenado'},
  {n:'Vita', e:'Muerto', c:'Envenenado en la Noche 9', m:'envenenado'},
  {n:'Marcos JC', e:'Muerto', c:'Asesinado en la Noche 8', m:'asesinado'},
  {n:'Ximena', e:'Desaparecida', c:'Entró en la Noche 7', m:'desaparecido'},
  {n:'Braulio', e:'Muerto', c:'Ejecutado en la Noche 6', m:'ejecutado'},
  {n:'Marianito', e:'Muerto', c:'Asesinado en la Noche 6', m:'asesinado'},
  {n:'Amanda Lewis', e:'Muerta', c:'Ejecutada en la Noche 5', m:'ejecutado'},
  {n:'Bodega Bodeguita', e:'Muerto', c:'Asesinado en la Noche 5', m:'asesinado'},
  {n:'Peggy', e:'Muerta', c:'Se suicidó en la Noche 5', m:'suicidio'},
  {n:'Antonio Ezequiel', e:'Muerto', c:'Ejecutado en la Noche 4', m:'ejecutado'},
  {n:'Beto', e:'Muerto', c:'Asesinado en la Noche 4', m:'asesinado'},
  {n:'Eris', e:'Muerto', c:'Ejecutado en la Noche 3', m:'ejecutado'},
  {n:'Renzo', e:'Muerto', c:'Asesinado en la Noche 3', m:'asesinado'},
  {n:'Bayron', e:'Cazador', c:'Falló y murió en la Noche 3', m:'cazador'},
  {n:'Harmony', e:'Muerta', c:'Ejecutada en la Noche 2', m:'ejecutado'},
  {n:'Julián', e:'Muerto', c:'Asesinado en la Noche 2', m:'asesinado'},
  {n:'Mischa Bachinski', e:'Muerto', c:'Se suicidó en la Noche 2', m:'suicidio'},
  {n:'Azael', e:'Muerto', c:'Ejecutado en la Noche 1', m:'ejecutado'},
  {n:'Cinthia Carral', e:'Cazadora', c:'Falló y murió en la Noche 1', m:'cazador'}
];

function slug(s){ return s.normalize('NFD').replace(/[\u0300-\u036f]/g,'').toLowerCase().replace(/ñ/g,'n').replace(/[^a-z0-9]+/g,'').trim() }
function imageCandidates(name){
  const base = slug(name);
  return [`Personajes/${name}.png`,`Personajes/${name}.jpg`,`Personajes/${base}.png`,`Personajes/${base}.jpg`,`Personajes/${(name.split(' ')[0]||'').trim()}.png`,`Personajes/${(name.split(' ')[0]||'').trim()}.jpg`];
}
function tryLoad(el, cands){
  let i=0;
  function next(){
    if(i>=cands.length){ el.innerHTML = `<div class="monogram">${(el.dataset.letter||'?')}</div>`; return; }
    const img = new Image(); const src = cands[i++];
    img.onload = ()=>{ el.innerHTML=''; el.appendChild(img) };
    img.onerror = ()=> next(); img.src = src;
  } next();
}

const mapFX = { vivo:'fx-glow', desaparecido:'fx-missing', ejecutado:'fx-fire', asesinado:'fx-blood', suicidio:'fx-blood', envenenado:'fx-venom', cazador:'fx-blood' };
const grid = document.getElementById('grid');

participantes.forEach(p=>{
  const card = document.createElement('article'); card.className='card'; card.setAttribute('tabindex','0'); card.setAttribute('role','button'); card.dataset.mode=p.m;
  const avatar = document.createElement('div'); avatar.className='avatar'; avatar.dataset.letter=p.n.charAt(0).toUpperCase(); tryLoad(avatar, imageCandidates(p.n)); card.appendChild(avatar);
  const fx = document.createElement('div'); fx.className='fx'; fx.classList.add(mapFX[p.m]||'fx-glow'); avatar.appendChild(fx);
  const name = document.createElement('h3'); name.className='name gold-emboss'; name.textContent=p.n; card.appendChild(name);
  const estado = document.createElement('p'); estado.className='estado'; estado.textContent=p.e; const eLower=p.e.toLowerCase();
  if(eLower.includes('viva')) estado.classList.add('alive');
  if(eLower.includes('muerto')||eLower.includes('muerta')||eLower.includes('cazador')||eLower.includes('cazadora')) estado.classList.add('dead');
  card.appendChild(estado);
  const causa = document.createElement('p'); causa.className='causa'; causa.textContent=p.c; card.appendChild(causa);
  if(p.m==='asesinado'||p.m==='suicidio'){ const mark=document.createElement('div'); mark.className='mark'; mark.textContent='🔪'; card.appendChild(mark) }
  if(p.m==='cazador'){ const mark=document.createElement('div'); mark.className='mark'; mark.textContent='🦌'; card.appendChild(mark) }

  // Hover FX visible
  const on = ()=> card.classList.add('active'); const off = ()=> card.classList.remove('active');
  avatar.addEventListener('mouseenter', on); avatar.addEventListener('mouseleave', off);
  card.addEventListener('mouseenter', on); card.addEventListener('mouseleave', off);

  // Click -> Lightbox (imagen + texto debajo)
  const openLB = ()=>{
    const lb = document.getElementById('lightbox');
    const lbImg = document.getElementById('lbImg');
    const lbName = document.getElementById('lbName');
    const lbEstado = document.getElementById('lbEstado');
    const lbCausa = document.getElementById('lbCausa');
    const imgTag = avatar.querySelector('img');
    if(imgTag){ lbImg.src = imgTag.src; lbImg.alt = p.n; } else { lbImg.removeAttribute('src'); lbImg.alt=''; }
    lbName.textContent = p.n;
    lbEstado.textContent = p.e;
    lbEstado.className = 'lb-estado reveal ' + (
      p.e.toLowerCase().includes('viva') ? 'status-alive' :
      p.e.toLowerCase().includes('desaparecid') ? 'status-missing' : 'status-dead'
    );
    lbCausa.textContent = p.c;
    lb.classList.add('open'); lb.setAttribute('aria-hidden','false');
  };
  avatar.addEventListener('click', (e)=>{ e.stopPropagation(); openLB(); });
  card.addEventListener('click', openLB);
  avatar.addEventListener('touchstart', (e)=>{ e.stopPropagation(); openLB(); }, {passive:true});

  grid.appendChild(card);
});

// Lightbox close
const lb = document.getElementById('lightbox');
document.getElementById('lbClose').addEventListener('click',()=>{ lb.classList.remove('open'); lb.setAttribute('aria-hidden','true') });
lb.addEventListener('click', (e)=>{ if(e.target===lb) { lb.classList.remove('open'); lb.setAttribute('aria-hidden','true') } });

// Audio
const audio = document.getElementById('bgAudio');
document.getElementById('toggleSound').addEventListener('click', () => {
  if(audio.paused){ audio.play().catch(()=>{}); document.getElementById('toggleSound').setAttribute('aria-pressed','true'); }
  else { audio.pause(); document.getElementById('toggleSound').setAttribute('aria-pressed','false'); }
});

// Gate + doors + logo overlay (con forzado de reflow para asegurar animación)
const gate = document.getElementById('gate');
const doors = document.getElementById('doors');
const overlay = document.getElementById('logoOverlay');
document.getElementById('enterBtn').addEventListener('click', () => {
  audio.play().catch(()=>{});
  document.getElementById('toggleSound').setAttribute('aria-pressed','true');

  // Mostrar puertas y forzar reflow para que la animación SI ocurra
  doors.style.display='block';
  void doors.offsetWidth; // <- fuerza reflow
  doors.classList.add('open');

  gate.style.display='none';
  document.body.classList.remove('gated');

  // Mostrar logo transparente y disolver
  if(overlay){
    overlay.className = 'show';
    setTimeout(()=>{ overlay.classList.add('fade'); }, 900);
    setTimeout(()=>{ overlay.style.display='none'; overlay.className=''; }, 1800);
  }

  // Ocultar paneles de puerta después
  setTimeout(()=>{ doors.style.display='none'; doors.classList.remove('open'); }, 1400);
});

// Micro demo FX
(function demoFX(){
  const cards = Array.from(document.querySelectorAll('.card'));
  cards.forEach((c,i)=>{
    setTimeout(()=>{ c.classList.add('active'); }, 90*i);
    setTimeout(()=>{ c.classList.remove('active'); }, 90*i + 900);
  });
})();
</script>
</body>
</html>
